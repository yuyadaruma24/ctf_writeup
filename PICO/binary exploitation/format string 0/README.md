# format string 0

- **CTF:** picoCTF 2025
- **Category:** binary exploitation
- **Difficulty:** Easy

## Description

Can you use your knowledge of format strings to make the customers happy?
Download the binary here.
Download the source here.
Additional details will be available after launching your challenge instance.

## Author
Cheng Zhang

## hint
1. This is an introduction of format string vulnerabilities. Look up "format specifiers" if you have never seen them before.
2. Just try out the different options


## Write-up

### 事前知識
`sigsegv`：プログラムがメモリに対して不正なアクセスを試みたときに発生するシグナル．無効なメモリアドレスの参照，配列の範囲外アクセスなどが含まれる．

### 解き方
1. choice1に着目
   ```
   void serve_patrick() {
    printf("%s %s\n%s\n%s %s\n%s",
            "Welcome to our newly-opened burger place Pico 'n Patty!",
            "Can you help the picky customers find their favorite burger?",
            "Here comes the first customer Patrick who wants a giant bite.",
            "Please choose from the following burgers:",
            "Breakf@st_Burger, Gr%114d_Cheese, Bac0n_D3luxe",
            "Enter your recommendation: ");
    fflush(stdout);

    char choice1[BUFSIZE];
    scanf("%s", choice1);
    char *menu1[3] = {"Breakf@st_Burger", "Gr%114d_Cheese", "Bac0n_D3luxe"};
    if (!on_menu(choice1, menu1, 3)) {
        printf("%s", "There is no such burger yet!\n");
        fflush(stdout);
    } else {
        int count = printf(choice1);
        if (count > 2 * BUFSIZE) {
            serve_bob();
        } else {
            printf("%s\n%s\n",
                    "Patrick is still hungry!",
                    "Try to serve him something of larger size!");
            fflush(stdout);
        }
    }
}
   ```
2.
```
char choice1[BUFSIZE];
//入力される値をBUFSIZE【32】以下で定義。
scanf("%s", choice1);
//入力された値をchoce1に代入。
```
3. `choice1にBUFSIZE`を超える値を定義することでsigsegvが発生しflagを獲得できる．

### 別解
https://qiita.com/nobunobu193193/items/a94cb85f7d91e0f1a679

### Flag
`FLAG : picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_74f6c0e7}`
