# PIE TIME
 
* * *
 
## 問題文
  
Author: Darkraicg492
 
### Description
 
Can you try to get the flag? Beware we have PIE!Connect to the program with netcat:
 
`$ nc rescued-float.picoctf.net 55660`
  
## HINT
Can you figure out what changed between the address you found locally and in the server output?
 
## writeup
 
- コマンドで以下が出力される

<img width="566" height="74" alt="スクリーンショット 2025-12-30 112940" src="https://github.com/user-attachments/assets/8ad2db1d-a61b-49ec-baa2-9b18d875fbd3" />

- vlan.cを見るとwin関数内にflagが隠されていると判断できる

    #include <stdio.h> #include <stdlib.h> #include <signal.h> #include <unistd.h> void segfault_handler() { printf("Segfault Occurred, incorrect address.\\n"); exit(0); } int win() { FILE *fptr; char c; printf("You won!\\n"); // Open file fptr = fopen("flag.txt", "r"); if (fptr == NULL) { printf("Cannot open file.\\n"); exit(0); } // Read contents from file c = fgetc(fptr); while (c != EOF) { printf ("%c", c); c = fgetc(fptr); } printf("\\n"); fclose(fptr); } int main() { signal(SIGSEGV, segfault_handler); setvbuf(stdout, NULL, _IONBF, 0); // _IONBF = Unbuffered printf("Address of main: %p\\n", &main); unsigned long val; printf("Enter the address to jump to, ex => 0x12345: "); scanf("%lx", &val); printf("Your input: %lx\\n", val); void (*foo)(void) = (void (*)())val; foo(); } 

- mainとwinのオフセットは以下の通り

<img width="669" height="111" alt="スクリーンショット 2025-12-30 113509" src="https://github.com/user-attachments/assets/11b357a2-93cf-426d-8c96-ffb663d75a53" />

- main関数の現在のアドレス からmainのオフセットを引いてwinのオフセットを加えればよい

### 解答
 
0x5c82a9da033d - 0x133d + 0x12a7
 
= 0x5c82a9da033d
 <!-- notionvc: 54537c33-7336-421c-b376-9fa757748168 -->
