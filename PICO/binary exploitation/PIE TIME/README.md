# PIE TIME
---
## writeup
# PIE TIME
 
* * *
 
## å•é¡Œæ–‡
 
&lt;aside&gt; â“
 
Author: Darkraicg492
 
### Description
 
Can you try to get the flag? Beware we have PIE!Connect to the program with netcat:
 
`$ nc rescued-float.picoctf.net 55660`
 
&lt;/aside&gt;
 
## HINT
 
&lt;aside&gt; ğŸ—£
 
Can you figure out what changed between the address you found locally and in the server output?
 
&lt;/aside&gt;
 
## writeup
 
- ã‚³ãƒãƒ³ãƒ‰ã§ä»¥ä¸‹ãŒå‡ºåŠ›ã•ã‚Œã‚‹

![image.png](attachment:074bd191-cfdb-483e-a7e6-61038f75ce97:image.png)

- vlan.cã‚’è¦‹ã‚‹ã¨winé–¢æ•°å†…ã«flagãŒéš ã•ã‚Œã¦ã„ã‚‹ã¨åˆ¤æ–­ã§ãã‚‹

    #include <stdio.h> #include <stdlib.h> #include <signal.h> #include <unistd.h> void segfault_handler() { printf("Segfault Occurred, incorrect address.\\n"); exit(0); } int win() { FILE *fptr; char c; printf("You won!\\n"); // Open file fptr = fopen("flag.txt", "r"); if (fptr == NULL) { printf("Cannot open file.\\n"); exit(0); } // Read contents from file c = fgetc(fptr); while (c != EOF) { printf ("%c", c); c = fgetc(fptr); } printf("\\n"); fclose(fptr); } int main() { signal(SIGSEGV, segfault_handler); setvbuf(stdout, NULL, _IONBF, 0); // _IONBF = Unbuffered printf("Address of main: %p\\n", &main); unsigned long val; printf("Enter the address to jump to, ex => 0x12345: "); scanf("%lx", &val); printf("Your input: %lx\\n", val); void (*foo)(void) = (void (*)())val; foo(); } 

- mainã¨winã®ã‚ªãƒ•ã‚»ãƒƒãƒˆã¯ä»¥ä¸‹ã®é€šã‚Š

![image.png](attachment:99089830-7896-4b97-8816-11009cfff525:image.png)

- mainé–¢æ•°ã®ç¾åœ¨ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ ã‹ã‚‰mainã®ã‚ªãƒ•ã‚»ãƒƒãƒˆã‚’å¼•ã„ã¦winã®ã‚ªãƒ•ã‚»ãƒƒãƒˆã‚’åŠ ãˆã‚Œã°ã‚ˆã„

### è§£ç­”
 
0x5c82a9da033d - 0x133d + 0x12a7
 
= 0x5c82a9da033d
 <!-- notionvc: 54537c33-7336-421c-b376-9fa757748168 -->
